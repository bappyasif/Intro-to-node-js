<!DOCTYPE html>
<html lang="en">
    <%- include("./partials/head.ejs") %>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-2">
                <%- include("./partials/nav.ejs") %>
            </div>
            <div class="col-sm-4">
                <h1><%= title %></h1>
                <form action="" method="post">
                    <fieldset>
                        <label for="name">Album Name</label>
                        <input 
                            type="text" name="name" id="name" placeholder="Album Name Goes Here...." required="true"
                            value='<%= album !== undefined ? album?.name : '' %>'
                        >
                    </fieldset>
                    <fieldset>
                        <label for="artist">Artist Name</label>
                        <select 
                            name="artist" id="artist"
                            placeholder="Select Artist"
                            required="true"
                        >
                        <% artists.sort((a,b) => (a.first_name.toUpperCase() < b.first_name.toUpperCase()) ? -1 : (a.first_name.toUpperCase() > b.first_name.toUpperCase> b.first_name.toUpperCase()) ? 1 : 0) %> 
                        <% artists?.forEach(artist => { %>
                            <option 
                                value=<%= artist._id %> 
                            ><%= artist.full_name %></option>
                        <% }) %>
                        </select>
                    </fieldset>
                    <fieldset>
                        <label for="genre">Album Genre</label>
                        <div>
                            <% genres?.forEach(genre => { %>
                                <input 
                                    type="checkbox" name="genre" 
                                    id=<%= genre._id %>
                                    value=<%= genre._id %>
                                    <%= genre.checked !== undefined ? "checked" : false %> 
                                >
                                <label for=<%= genre._id %>>
                                    <%= genre.name %> <%= genre.checked %> 
                                </label>
                            <% }) %>
                        </div>                        
                    </fieldset>
                    <fieldset>
                        <label for="r_date">Released Date</label>
                        <input 
                            type="date" name="r_date" id="r_date"
                            value=<%= album?.form_date %>
                        >
                    </fieldset>
                    <fieldset>
                        <label for="descr">Album Description</label>
                        <textarea name="descr" id="descr" rows="2" placeholder="enter description">
                            <%= album?.description %>
                        </textarea>
                    </fieldset>
                    <fieldset>
                        <label for="price">Retail Price</label>
                        <input 
                            type="number" name="price" id="price"
                            value=<%= album?.price %> 
                        >
                    </fieldset>
                    <button type="submit">Submit</button>
                </form>
                <hr>
                <hr>
                <ul>
                    <% errors?.forEach(error => { %>
                        <li><%= error.msg %> </li>
                    <% }) %>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>